<!doctype html><html xmlns=http://www.w3.org/1999/xhtml lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>The Behavior of Modulo operation | 6cdh's Blog</title><meta property='og:title' content="The Behavior of Modulo operation - 6cdh's Blog"><meta property='og:description' content='The modulo operator can be found in almost every programming language. However, the
behavior of how they are defined depends on the language.'><meta property='og:url' content='https://6cdh.github.io/posts/modulo_operation/'><meta property='og:site_name' content="6cdh's Blog"><meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/b8cddc4add92aa9aa4ad41498604c028?s=256'><meta property='article:section' content='Posts'><meta property='article:published_time' content='2021-03-16T23:02:50+08:00'><meta property='article:modified_time' content='2021-03-16T23:02:50+08:00'><meta name=twitter:card content='summary'><meta name=twitter:site content='@'><meta name=twitter:creator content='@'><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://6cdh.github.io/custom.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://6cdh.github.io/posts/modulo_operation/><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><section class=section><div class=container><nav id=nav-main class=nav><div id=nav-name class=nav-left><a id=nav-anchor class=nav-item href=https://6cdh.github.io/><h1 id=nav-heading class="title is-4">6cdh's Blog</h1></a></div><div class=nav-right><nav id=nav-items class="nav-item level is-mobile"><a class=level-item aria-label=github href=https://github.com/6cdh target=_blank rel='me noopener'><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg>
</i></span></a><a class=level-item aria-label=email href=mailto:cd6cdh@gmail.com target=_blank rel='me noopener'><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</i></span></a><a class=level-item aria-label=rss href=/index.xml target=_blank rel='me noopener'><span class=icon><i><svg viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></i></span></a></nav></div></nav><nav class=nav></nav></div><script src=/js/navicon-shift.js></script></section><section class=section><div class=container><div class="subtitle tags is-6 is-pulled-right"></div><h2 class="subtitle is-6">March 16, 2021</h2><h1 class=title>The Behavior of Modulo operation</h1><div class=content><p>The modulo operator can be found in almost every programming language. However, the
behavior of how they are defined depends on the language.</p><h2 id=the-modulo-operation>The Modulo Operation</h2><p>Given two numbers $a$ and $b$, the quotient $q$ and the remainder $r$ of $a$ divided by
$b$ satisfy the following conditions:</p><p>$$
\begin{aligned}
& q \in Z \cr
& a = bq + r \cr
& |r| &lt; |b| \cr
\end{aligned}
$$</p><p>Obviously, $r$ should be a positive number if $a$ and $b$ are positive. That is, $r$ is the remainder of the
Euclidean division.</p><p>However, it will leave a sign ambiguity if $a$ or $b$ is nonpositive. In mathematics, the
result of the modulo operation is an equivalence class, and any number of the class may be
chosen as representative. For example,</p><p>$$
14 \bmod -3
$$</p><p>may yield 2 or -2. Either of them is correct. In a real programming language, we know, it
can&rsquo;t yield an ambiguous result for a given expression. Which should be chosen?</p><h2 id=variants-of-modulo-definitions>Variants of Modulo Definitions</h2><p>Many programming languages like C/C++ use truncated division which returns the integer nearest
$q$ (real quotient) between zero and $q$:</p><p>$$
\text{trunc}\left(\frac{a}{b}\right) =
\begin{cases}
\lfloor a/b\rfloor & a/b \ge 0\cr
\lceil a/b \rceil & \text{else}\cr
\end{cases}
$$</p><p>So the remainder will be</p><p>$$
r_{\text{trunc}} = a - b \times \text{trunc}\left(\frac{a}{b}\right)
$$</p><p>The programming languages like Python have a floored division which returns the
floor function of the real quotient:</p><p>$$
\left\lfloor \frac{a}{b} \right\rfloor
$$</p><p>So the remainder will be</p><p>$$
r_{\text{floor}} = a - b\times \left\lfloor \frac{a}{b}\right\rfloor
$$</p><p>IEEE 754 defines the rounding division:</p><p>$$
\text{round}\left( \frac{a}{b} \right) = \begin{cases}
\lfloor a/b \rfloor & a/b - \lfloor a/b \rfloor &lt; 0.5\cr
\lceil a/b \rceil \text{ bitand } -2 & a/b - \lfloor a/b \rfloor = 0.5\cr
\lceil a/b \rceil & a/b - \lfloor a/b \rfloor > 0.5
\end{cases}
$$</p><p>We have</p><p>$$
r_{\text{round}} = a - b \times \text{round}\left( \frac{a}{b} \right)
$$</p><p>In C89/C++98, the quotient is rounded in implementation-defined direction. Since C99/
C++11, the quotient is truncated towards zero. So modern C/C++ uses truncated modulo
(the first case above).</p><p>In Go, the modulo operator is truncated. In Python, the floored modulo is used (the second
case above).</p><p>In Haskell, <code>mod</code> is a floored modulo, <code>rem</code> is a truncated modulo. <a href=https://en.wikipedia.org/wiki/Modulo_operation>Wikipedia</a> gives a
full list.</p><p>The truncated modulo and the floored modulo are common. I will just cover them.</p><h2 id=the-properties-of-the-modulo-operations>The Properties of The Modulo Operations</h2><p>When $a/b \ge 0$, the truncated modulo and the floored modulo are the same.</p><p>$$
r_{\text{trunc}} = r_{\text{floor}}
$$</p><p>We just need to study the negative case. Let the real quotient $q$ be</p><p>$$
q = \frac{a}{b} = d + \delta
$$</p><p>where $d$ and $\delta$ is the integer and fractional parts of $q$, respectively. For example,
$-4.2=-4 + -0.2 = d + \delta$.</p><p>Then</p><p>$$
\begin{aligned}
r_{\text{trunc}} & = a - b\left\lceil \frac{a}{b} \right\rceil = a-bd\cr
r_{\text{floor}} & = a - b\left\lfloor \frac{a}{b} \right\rfloor = a-bd+b
\end{aligned}
$$</p><p>Generally, we always have two available remainder (the positive one and the negative one).
$r_{\text{floor}}$ is the positive one and $r_{\text{trunc}}$ is negative for
$a&lt;0\land b>0$. $r_{\text{floor}}$ is the negative one and $r_{\text{trunc}}$ is positive
for $a>0\land b&lt;0$.</p><p>That is, the sign of $r_{\text{floor}}$ is same as the divisor. The sign of
$r_{\text{trunc}}$ is same as the dividend.</p><h2 id=references>References</h2><ul><li><a href=https://en.wikipedia.org/wiki/Modulo_operation>Modulo operation - Wikipedia</a></li></ul></div></div></section><section class=section><div class=container><aside><div id=disqus_thread></div></aside><div id=show_comments><a id=load_comments class="button is-link">Load comments</a></div><script type=text/javascript>var hash,disqus_shortname="6cdh-github-io";function disqus(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}hash=window.location.hash.substr(1),hash.length>8&&hash.substring(0,8)==="comment-"?(disqus(),document.getElementById("show_comments").style.display="none"):document.getElementById("load_comments").onclick=function(){disqus(),document.getElementById("show_comments").style.display="none"}</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p></p><p>Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/ribice/kiss>Kiss</a>.</p></div></section></body></html>